# Análisis de componentes principales aplicado a metabolómica

Es hora de poner en práctica todo lo que hemos abordado en los capítulos anteriores.  

## Datos

Los datos en este capítulo fueron generados aleatoriamente a partir de las medias y desviaciones estándar publicadas en <a href="https://pubmed.ncbi.nlm.nih.gov/17118972/" target="_blank">Time-course metabolic profiling in Arabidopsis thaliana cell cultures after salt stress treatment</a>. Si el lector tiene curiosidad puede consultar el archivo "simulacion_datos_met.R" en la carpeta "codigoR" situada en el repositorio de este manual. Los datos también se encuentran en el mismo repositorio dentro la carpeta datos.  

Los datos corresponden a un experimento con plantas de *Arabidopsis thalania*, de la cuales se realizaron cultivos celulares que fueron sometidos a distintos tiempos de estrés salino. El estrés salino es un factor importante que limita el crecimiento de las plantas y en el estudio estaban interesados en cómo cambia el nivel de algunos metabolitos primarios en estas condiciones.  

<img src="imagenes/experimento_met.png" style="display: block; margin: auto;" />

Como dato extra, la metabolómica es el estudio de las moléculas producidas por metabolismo celular, ya sea de plantas, bacterias, animales, etc.  

Las primeras diez columnas de nuestros datos se ven de la siguiente forma.  


```r
library(dplyr)

datos_met <- readr::read_csv("datos/datos_met_completos.csv")
head(datos_met, n = 10)
```

```
## # A tibble: 10 × 4
##    Metabolito    Tiempo Muestra    CR
##    <chr>          <dbl>   <dbl> <dbl>
##  1 aspartic acid    0.5       1 0.728
##  2 aspartic acid    0.5       2 0.839
##  3 aspartic acid    0.5       3 0.707
##  4 aspartic acid    1         1 0.746
##  5 aspartic acid    1         2 0.894
##  6 aspartic acid    1         3 0.686
##  7 aspartic acid    2         1 0.772
##  8 aspartic acid    2         2 0.762
##  9 aspartic acid    2         3 0.783
## 10 aspartic acid    4         1 1.16
```

Es estos datos, `CR` signific "Cantidad Relativa" mientras que `Muestra` se refiere a las repeticiones por tratamiento o tiempo, que en cada caso fueron tres.  

## Reordenamiento de los datos

Los datos como se muestran en la sección anterior están registrados de la manera usual y necesaria para hacer análisis de varianza o regresión. Pero en el caso de *PCA* necesitamos reordenarlos de tal manera que en las columnas se especifique cada variable (la cantidad relativa de cada metabolito) y en los renglones los pares muestra-tiempo.  


```r
library(tidyr)

dt_r <- datos_met %>% 
  mutate(Muestra_Tiempo = paste0(Muestra, "-", Tiempo)) %>% 
  pivot_wider(
    names_from = Muestra_Tiempo, values_from = CR, -Tiempo:-Muestra
  )

met_cr <- t(dt_r[, -1])
colnames(met_cr) <- dt_r$Metabolito

met_cr[1:10, 1:5]
```

```
##       aspartic acid asparagine serine glycine alanine
## 1-0.5         0.728      1.100  0.776   0.907   0.956
## 2-0.5         0.839      0.978  0.789   0.908   0.960
## 3-0.5         0.707      1.170  0.819   0.908   0.935
## 1-1           0.746      1.000  0.828   0.857   0.829
## 2-1           0.894      0.957  0.861   0.851   0.811
## 3-1           0.686      0.953  0.796   0.858   0.844
## 1-2           0.772      1.200  0.927   0.958   0.848
## 2-2           0.762      1.290  0.829   0.970   0.790
## 3-2           0.783      1.410  1.030   0.961   0.884
## 1-4           1.160      1.020  0.899   0.826   0.937
```

## Análisis de componentes principales con prcomp()

Ahora que nuestros datos tienen la estructura adecuada podemos realizar el *PCA* con la función `prcomp()`.  


```r
met_pca <- prcomp(met_cr, scale. = TRUE)
```

Como vimos en el capítulo anterior `prcomp()` devuelve un listado con las proyecciones de los datos, los pesos y valores propios de la matriz de covarianzas. También podemos utilizar la función `summary()` para desplegar un resumen donde solo se mostrará información sobre las varianzas y desviaciones estándar de cada componente principal.  


```r
summary(met_pca)
```

```
## Importance of components:
##                           PC1    PC2     PC3     PC4     PC5     PC6     PC7
## Standard deviation     4.3029 3.2325 1.95743 1.47536 1.46428 1.24333 1.06827
## Proportion of Variance 0.4306 0.2430 0.08911 0.05062 0.04986 0.03595 0.02654
## Cumulative Proportion  0.4306 0.6736 0.76269 0.81331 0.86318 0.89913 0.92567
##                            PC8    PC9    PC10    PC11    PC12    PC13    PC14
## Standard deviation     0.90340 0.7124 0.59916 0.52426 0.50298 0.44789 0.40629
## Proportion of Variance 0.01898 0.0118 0.00835 0.00639 0.00588 0.00467 0.00384
## Cumulative Proportion  0.94465 0.9565 0.96480 0.97119 0.97707 0.98174 0.98558
##                           PC15   PC16    PC17    PC18    PC19    PC20    PC21
## Standard deviation     0.37458 0.3471 0.31526 0.27399 0.24645 0.23404 0.18432
## Proportion of Variance 0.00326 0.0028 0.00231 0.00175 0.00141 0.00127 0.00079
## Cumulative Proportion  0.98884 0.9916 0.99395 0.99570 0.99711 0.99839 0.99918
##                           PC22    PC23      PC24
## Standard deviation     0.15186 0.11112 6.526e-16
## Proportion of Variance 0.00054 0.00029 0.000e+00
## Cumulative Proportion  0.99971 1.00000 1.000e+00
```

### Gráfica de barras con la varianza de cada componente principal


```r
library(ggplot2)
library(purrr)

# Valores propios
vp_prcomp <- met_pca$sdev^2 / (nrow(datos_met) - 1)

# Porcentaje de variación para cada componente principal
per_pc <- data.frame(vp_prcomp) %>% 
  mutate(
    per_var = vp_prcomp * 100 / sum(vp_prcomp),
    pc = map_chr(
      1:nrow(met_pca$x), .f = function(x) paste0("PC", as.character(x))
      )
  )

# Gráfica con porcentajes para los primeros 15 componentes 
ggplot(per_pc[1:15,], aes(reorder(pc, -per_var), per_var)) +
  geom_col(fill = "cornflowerblue", color = "black") +
  xlab("Componente principal") +
  ylab("Porcentaje de variación (%)") +
  theme_classic()
```

<img src="05-PCA-metabolomica_files/figure-html/barras varianza pca-1.png" width="672" />

Los primeros dos componentes abarcan alrededor del 70% de la variación total en los datos, por lo que una gráfica de dispersión con estos dos componentes nos podría dar una idea de las semejanzas o diferencias entre los distintos tiempos de estrés salino.  

### Gráfica de dispesión con los primeros dos componentes

Podemos darle un aspecto interactivo a nuestra gráfica de dispersión con la función `ggploty()` del paquete `plotly`. 


```r
library(plotly)

# Porcentajes de variación de los primeros dos componentes
per_var_pc12 <- round(per_pc$per_var[1:2], 1)

# Tiempos
tiempo <- as.factor(substr(rownames(met_pca$x), start = 3, stop =5))
levels(tiempo) <- c("0.5", "1", "2", "4", "12", "24", "48", "72")

# Proyecciones
met_p <- met_pca$x %>% 
  as.data.frame() %>% 
  mutate(Tiempo = tiempo) %>% 
  relocate(Tiempo)

# Gráfica de dispersión de los primeros dos componente
pc12 <- ggplot(met_p, aes(PC1, PC2, color = Tiempo)) +
  geom_point(size = 2) +
  xlab(paste0("PC1 ", "(", per_var_pc12[1], "%)")) + 
  ylab(paste0("PC2 ", "(", per_var_pc12[2], "%)")) +
  theme_classic() +
  scale_color_brewer(palette = "Dark2")

ggplotly(pc12)
```

```{=html}
<div id="htmlwidget-770d633e5a50f3d23936" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-770d633e5a50f3d23936">{"x":{"data":[{"x":[-2.12122600516657,-2.32399204836693,-2.04910477825321],"y":[0.808266357908535,0.735017874112091,0.911557344807418],"text":["PC1: -2.1212260<br />PC2:  0.8082664<br />Tiempo: 0.5","PC1: -2.3239920<br />PC2:  0.7350179<br />Tiempo: 0.5","PC1: -2.0491048<br />PC2:  0.9115573<br />Tiempo: 0.5"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(27,158,119,1)","opacity":1,"size":7.55905511811024,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(27,158,119,1)"}},"hoveron":"points","name":"0.5","legendgroup":"0.5","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-3.35130786056271,-5.07189592264523,-3.17618764740237],"y":[2.11059213133851,2.48506479451762,2.37681249362506],"text":["PC1: -3.3513079<br />PC2:  2.1105921<br />Tiempo: 1","PC1: -5.0718959<br />PC2:  2.4850648<br />Tiempo: 1","PC1: -3.1761876<br />PC2:  2.3768125<br />Tiempo: 1"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(217,95,2,1)","opacity":1,"size":7.55905511811024,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(217,95,2,1)"}},"hoveron":"points","name":"1","legendgroup":"1","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-1.00518710723258,-0.48001525887029,-0.768239734253911],"y":[-2.43681214193563,-2.77590587744332,-2.10909385732774],"text":["PC1: -1.0051871<br />PC2: -2.4368121<br />Tiempo: 2","PC1: -0.4800153<br />PC2: -2.7759059<br />Tiempo: 2","PC1: -0.7682397<br />PC2: -2.1090939<br />Tiempo: 2"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(117,112,179,1)","opacity":1,"size":7.55905511811024,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(117,112,179,1)"}},"hoveron":"points","name":"2","legendgroup":"2","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-4.11853041626833,-4.06136120265695,-4.38420221898082],"y":[2.84044884668404,2.65600526427866,2.86549262318591],"text":["PC1: -4.1185304<br />PC2:  2.8404488<br />Tiempo: 4","PC1: -4.0613612<br />PC2:  2.6560053<br />Tiempo: 4","PC1: -4.3842022<br />PC2:  2.8654926<br />Tiempo: 4"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(231,41,138,1)","opacity":1,"size":7.55905511811024,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(231,41,138,1)"}},"hoveron":"points","name":"4","legendgroup":"4","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[2.82873820185473,3.43562326548284,3.41105039514546],"y":[-6.17055406360572,-6.70382158294645,-5.84994679918565],"text":["PC1:  2.8287382<br />PC2: -6.1705541<br />Tiempo: 12","PC1:  3.4356233<br />PC2: -6.7038216<br />Tiempo: 12","PC1:  3.4110504<br />PC2: -5.8499468<br />Tiempo: 12"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(102,166,30,1)","opacity":1,"size":7.55905511811024,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(102,166,30,1)"}},"hoveron":"points","name":"12","legendgroup":"12","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-2.78606533491767,-3.32841694266783,-3.17942443781314],"y":[-0.846706129788329,-0.731896346128902,-1.23555167704319],"text":["PC1: -2.7860653<br />PC2: -0.8467061<br />Tiempo: 24","PC1: -3.3284169<br />PC2: -0.7318963<br />Tiempo: 24","PC1: -3.1794244<br />PC2: -1.2355517<br />Tiempo: 24"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(230,171,2,1)","opacity":1,"size":7.55905511811024,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(230,171,2,1)"}},"hoveron":"points","name":"24","legendgroup":"24","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[2.25279432530027,1.89650275420491,1.64302139958102],"y":[-0.927634616340242,-0.21524958804737,-1.04158509682791],"text":["PC1:  2.2527943<br />PC2: -0.9276346<br />Tiempo: 48","PC1:  1.8965028<br />PC2: -0.2152496<br />Tiempo: 48","PC1:  1.6430214<br />PC2: -1.0415851<br />Tiempo: 48"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(166,118,29,1)","opacity":1,"size":7.55905511811024,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(166,118,29,1)"}},"hoveron":"points","name":"48","legendgroup":"48","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[8.67355327290662,9.19983693555442,8.86403636602829],"y":[4.50399806235974,4.32092153633014,4.43058044747274],"text":["PC1:  8.6735533<br />PC2:  4.5039981<br />Tiempo: 72","PC1:  9.1998369<br />PC2:  4.3209215<br />Tiempo: 72","PC1:  8.8640364<br />PC2:  4.4305804<br />Tiempo: 72"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(102,102,102,1)","opacity":1,"size":7.55905511811024,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(102,102,102,1)"}},"hoveron":"points","name":"72","legendgroup":"72","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":26.2283105022831,"r":7.30593607305936,"b":40.1826484018265,"l":48.9497716894977},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-5.78548256555521,9.9134235784644],"tickmode":"array","ticktext":["-5","0","5"],"tickvals":[-5,0,5],"categoryorder":"array","categoryarray":["-5","0","5"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"y","title":{"text":"PC1 (43.1%)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-7.26421256521176,5.06438904462505],"tickmode":"array","ticktext":["-5.0","-2.5","0.0","2.5","5.0"],"tickvals":[-5,-2.5,0,2.5,5],"categoryorder":"array","categoryarray":["-5.0","-2.5","0.0","2.5","5.0"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":{"text":"PC2 (24.3%)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"title":{"text":"Tiempo","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"1ec50d52e04":{"x":{},"y":{},"colour":{},"type":"scatter"}},"cur_data":"1ec50d52e04","visdat":{"1ec50d52e04":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
```

Podemos observar una clara diferenciación entre los distintos tiempos de estrés. En particular el tiempo de 72 horas a lo largo de *PC1* y el tiempo de 12 horas a lo largo de *PC2*.  

### Peso o *loadings* de PC1 y PC2

Para determinar qué metabolitos son los que tienen una mayor peso o importancia en las agrupaciones o diferencias observadas en la gráfica anterior, podemos realizar una gráfica de paletas (*lollipop chart*) con los pesos absolutos de cada metabolito (ordenados de mayor a menor). Los pesos se encuentran en `rotation` dentro de los resultados devueltos por `prcomp()`.  

Primero observemos los referente al primer componente principal.  


```r
# Obtener los pesos correspondientes de PC1
pesos_pc1 <- met_pca$rotation %>% 
  as.data.frame() %>% 
  select(PC1) %>% 
  mutate(Metabolito = row.names(met_pca$rotation)) %>% 
  mutate(PC1 = round(abs(PC1), 3)) %>% 
  rename(Peso = PC1)

# Gráfica de paletas con pesos de mayor a menor
lolch_ppc1 <- pesos_pc1 %>% 
  ggplot(aes(x = Peso, y = reorder(Metabolito, Peso))) + 
  geom_segment(aes(x = 0, xend = Peso, yend = Metabolito), color = "black") +
  geom_point(col = "black", pch = 21, bg = "#EE3B3B") +
  xlab("Peso") +
  ylab("Metabolito") +
  ggtitle("Pesos o loadigns en PC1") +
  theme_classic()

# Aspecto interactivo con ggplotly()
ggplotly(lolch_ppc1)
```

```{=html}
<div id="htmlwidget-22bc7dddc2a6070e002d" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-22bc7dddc2a6070e002d">{"x":{"data":[{"x":[0,0.171,null,0,0.168,null,0,0.109,null,0,0.007,null,0,0.202,null,0,0.065,null,0,0.114,null,0,0.134,null,0,0.107,null,0,0.222,null,0,0.195,null,0,0.212,null,0,0.225,null,0,0.172,null,0,0.199,null,0,0.216,null,0,0.032,null,0,0.003,null,0,0.187,null,0,0.068,null,0,0.093,null,0,0.044,null,0,0.145,null,0,0.05,null,0,0.177,null,0,0.154,null,0,0.185,null,0,0.09,null,0,0.113,null,0,0.151,null,0,0.156,null,0,0.161,null,0,0.166,null,0,0.122,null,0,0.189,null,0,0.188,null,0,0.175,null,0,0.194,null,0,0.167,null,0,0.164,null,0,0.018,null,0,0.185,null,0,0.123],"y":[27,27,null,26,26,null,12,12,null,2,2,null,39,39,null,7,7,null,14,14,null,17,17,null,11,11,null,42,42,null,37,37,null,40,40,null,43,43,null,28,28,null,38,38,null,41,41,null,4,4,null,1,1,null,33,33,null,8,8,null,10,10,null,5,5,null,18,18,null,6,6,null,30,30,null,20,20,null,31,31,null,9,9,null,13,13,null,19,19,null,21,21,null,22,22,null,24,24,null,15,15,null,35,35,null,34,34,null,29,29,null,36,36,null,25,25,null,23,23,null,3,3,null,32,32,null,16,16],"text":["x: 0<br />reorder(Metabolito, Peso): aspartic acid<br />Peso: 0.171<br />Metabolito: 27","x: 0<br />reorder(Metabolito, Peso): aspartic acid<br />Peso: 0.171<br />Metabolito: 27",null,"x: 0<br />reorder(Metabolito, Peso): asparagine<br />Peso: 0.168<br />Metabolito: 26","x: 0<br />reorder(Metabolito, Peso): asparagine<br />Peso: 0.168<br />Metabolito: 26",null,"x: 0<br />reorder(Metabolito, Peso): serine<br />Peso: 0.109<br />Metabolito: 12","x: 0<br />reorder(Metabolito, Peso): serine<br />Peso: 0.109<br />Metabolito: 12",null,"x: 0<br />reorder(Metabolito, Peso): glycine<br />Peso: 0.007<br />Metabolito:  2","x: 0<br />reorder(Metabolito, Peso): glycine<br />Peso: 0.007<br />Metabolito:  2",null,"x: 0<br />reorder(Metabolito, Peso): alanine<br />Peso: 0.202<br />Metabolito: 39","x: 0<br />reorder(Metabolito, Peso): alanine<br />Peso: 0.202<br />Metabolito: 39",null,"x: 0<br />reorder(Metabolito, Peso): glutamic acid<br />Peso: 0.065<br />Metabolito:  7","x: 0<br />reorder(Metabolito, Peso): glutamic acid<br />Peso: 0.065<br />Metabolito:  7",null,"x: 0<br />reorder(Metabolito, Peso): glutamine<br />Peso: 0.114<br />Metabolito: 14","x: 0<br />reorder(Metabolito, Peso): glutamine<br />Peso: 0.114<br />Metabolito: 14",null,"x: 0<br />reorder(Metabolito, Peso): threonine<br />Peso: 0.134<br />Metabolito: 17","x: 0<br />reorder(Metabolito, Peso): threonine<br />Peso: 0.134<br />Metabolito: 17",null,"x: 0<br />reorder(Metabolito, Peso): proline<br />Peso: 0.107<br />Metabolito: 11","x: 0<br />reorder(Metabolito, Peso): proline<br />Peso: 0.107<br />Metabolito: 11",null,"x: 0<br />reorder(Metabolito, Peso): valine<br />Peso: 0.222<br />Metabolito: 42","x: 0<br />reorder(Metabolito, Peso): valine<br />Peso: 0.222<br />Metabolito: 42",null,"x: 0<br />reorder(Metabolito, Peso): tryptophan<br />Peso: 0.195<br />Metabolito: 37","x: 0<br />reorder(Metabolito, Peso): tryptophan<br />Peso: 0.195<br />Metabolito: 37",null,"x: 0<br />reorder(Metabolito, Peso): isoleucine<br />Peso: 0.212<br />Metabolito: 40","x: 0<br />reorder(Metabolito, Peso): isoleucine<br />Peso: 0.212<br />Metabolito: 40",null,"x: 0<br />reorder(Metabolito, Peso): leucine<br />Peso: 0.225<br />Metabolito: 43","x: 0<br />reorder(Metabolito, Peso): leucine<br />Peso: 0.225<br />Metabolito: 43",null,"x: 0<br />reorder(Metabolito, Peso): phenylalanine<br />Peso: 0.172<br />Metabolito: 28","x: 0<br />reorder(Metabolito, Peso): phenylalanine<br />Peso: 0.172<br />Metabolito: 28",null,"x: 0<br />reorder(Metabolito, Peso): pyruvate<br />Peso: 0.199<br />Metabolito: 38","x: 0<br />reorder(Metabolito, Peso): pyruvate<br />Peso: 0.199<br />Metabolito: 38",null,"x: 0<br />reorder(Metabolito, Peso): lactate<br />Peso: 0.216<br />Metabolito: 41","x: 0<br />reorder(Metabolito, Peso): lactate<br />Peso: 0.216<br />Metabolito: 41",null,"x: 0<br />reorder(Metabolito, Peso): phosphorate<br />Peso: 0.032<br />Metabolito:  4","x: 0<br />reorder(Metabolito, Peso): phosphorate<br />Peso: 0.032<br />Metabolito:  4",null,"x: 0<br />reorder(Metabolito, Peso): n-butylamine<br />Peso: 0.003<br />Metabolito:  1","x: 0<br />reorder(Metabolito, Peso): n-butylamine<br />Peso: 0.003<br />Metabolito:  1",null,"x: 0<br />reorder(Metabolito, Peso): ethanolamine<br />Peso: 0.187<br />Metabolito: 33","x: 0<br />reorder(Metabolito, Peso): ethanolamine<br />Peso: 0.187<br />Metabolito: 33",null,"x: 0<br />reorder(Metabolito, Peso): glycerol<br />Peso: 0.068<br />Metabolito:  8","x: 0<br />reorder(Metabolito, Peso): glycerol<br />Peso: 0.068<br />Metabolito:  8",null,"x: 0<br />reorder(Metabolito, Peso): succinate<br />Peso: 0.093<br />Metabolito: 10","x: 0<br />reorder(Metabolito, Peso): succinate<br />Peso: 0.093<br />Metabolito: 10",null,"x: 0<br />reorder(Metabolito, Peso): glycerate<br />Peso: 0.044<br />Metabolito:  5","x: 0<br />reorder(Metabolito, Peso): glycerate<br />Peso: 0.044<br />Metabolito:  5",null,"x: 0<br />reorder(Metabolito, Peso): fumarate<br />Peso: 0.145<br />Metabolito: 18","x: 0<br />reorder(Metabolito, Peso): fumarate<br />Peso: 0.145<br />Metabolito: 18",null,"x: 0<br />reorder(Metabolito, Peso): cadaverine<br />Peso: 0.050<br />Metabolito:  6","x: 0<br />reorder(Metabolito, Peso): cadaverine<br />Peso: 0.050<br />Metabolito:  6",null,"x: 0<br />reorder(Metabolito, Peso): malate<br />Peso: 0.177<br />Metabolito: 30","x: 0<br />reorder(Metabolito, Peso): malate<br />Peso: 0.177<br />Metabolito: 30",null,"x: 0<br />reorder(Metabolito, Peso): 4-aminobutyrate<br />Peso: 0.154<br />Metabolito: 20","x: 0<br />reorder(Metabolito, Peso): 4-aminobutyrate<br />Peso: 0.154<br />Metabolito: 20",null,"x: 0<br />reorder(Metabolito, Peso): cysteine<br />Peso: 0.185<br />Metabolito: 31","x: 0<br />reorder(Metabolito, Peso): cysteine<br />Peso: 0.185<br />Metabolito: 31",null,"x: 0<br />reorder(Metabolito, Peso): a-ketoglutarate<br />Peso: 0.090<br />Metabolito:  9","x: 0<br />reorder(Metabolito, Peso): a-ketoglutarate<br />Peso: 0.090<br />Metabolito:  9",null,"x: 0<br />reorder(Metabolito, Peso): aconitate<br />Peso: 0.113<br />Metabolito: 13","x: 0<br />reorder(Metabolito, Peso): aconitate<br />Peso: 0.113<br />Metabolito: 13",null,"x: 0<br />reorder(Metabolito, Peso): putrescine<br />Peso: 0.151<br />Metabolito: 19","x: 0<br />reorder(Metabolito, Peso): putrescine<br />Peso: 0.151<br />Metabolito: 19",null,"x: 0<br />reorder(Metabolito, Peso): ribonate<br />Peso: 0.156<br />Metabolito: 21","x: 0<br />reorder(Metabolito, Peso): ribonate<br />Peso: 0.156<br />Metabolito: 21",null,"x: 0<br />reorder(Metabolito, Peso): shikimate<br />Peso: 0.161<br />Metabolito: 22","x: 0<br />reorder(Metabolito, Peso): shikimate<br />Peso: 0.161<br />Metabolito: 22",null,"x: 0<br />reorder(Metabolito, Peso): citrate<br />Peso: 0.166<br />Metabolito: 24","x: 0<br />reorder(Metabolito, Peso): citrate<br />Peso: 0.166<br />Metabolito: 24",null,"x: 0<br />reorder(Metabolito, Peso): D-fructose<br />Peso: 0.122<br />Metabolito: 15","x: 0<br />reorder(Metabolito, Peso): D-fructose<br />Peso: 0.122<br />Metabolito: 15",null,"x: 0<br />reorder(Metabolito, Peso): glucose<br />Peso: 0.189<br />Metabolito: 35","x: 0<br />reorder(Metabolito, Peso): glucose<br />Peso: 0.189<br />Metabolito: 35",null,"x: 0<br />reorder(Metabolito, Peso): lysine<br />Peso: 0.188<br />Metabolito: 34","x: 0<br />reorder(Metabolito, Peso): lysine<br />Peso: 0.188<br />Metabolito: 34",null,"x: 0<br />reorder(Metabolito, Peso): tyrosine<br />Peso: 0.175<br />Metabolito: 29","x: 0<br />reorder(Metabolito, Peso): tyrosine<br />Peso: 0.175<br />Metabolito: 29",null,"x: 0<br />reorder(Metabolito, Peso): gluconate<br />Peso: 0.194<br />Metabolito: 36","x: 0<br />reorder(Metabolito, Peso): gluconate<br />Peso: 0.194<br />Metabolito: 36",null,"x: 0<br />reorder(Metabolito, Peso): galactonate<br />Peso: 0.167<br />Metabolito: 25","x: 0<br />reorder(Metabolito, Peso): galactonate<br />Peso: 0.167<br />Metabolito: 25",null,"x: 0<br />reorder(Metabolito, Peso): inositol<br />Peso: 0.164<br />Metabolito: 23","x: 0<br />reorder(Metabolito, Peso): inositol<br />Peso: 0.164<br />Metabolito: 23",null,"x: 0<br />reorder(Metabolito, Peso): uric acid<br />Peso: 0.018<br />Metabolito:  3","x: 0<br />reorder(Metabolito, Peso): uric acid<br />Peso: 0.018<br />Metabolito:  3",null,"x: 0<br />reorder(Metabolito, Peso): sucrose<br />Peso: 0.185<br />Metabolito: 32","x: 0<br />reorder(Metabolito, Peso): sucrose<br />Peso: 0.185<br />Metabolito: 32",null,"x: 0<br />reorder(Metabolito, Peso): trehalose<br />Peso: 0.123<br />Metabolito: 16","x: 0<br />reorder(Metabolito, Peso): trehalose<br />Peso: 0.123<br />Metabolito: 16"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.171,0.168,0.109,0.007,0.202,0.065,0.114,0.134,0.107,0.222,0.195,0.212,0.225,0.172,0.199,0.216,0.032,0.003,0.187,0.068,0.093,0.044,0.145,0.05,0.177,0.154,0.185,0.09,0.113,0.151,0.156,0.161,0.166,0.122,0.189,0.188,0.175,0.194,0.167,0.164,0.018,0.185,0.123],"y":[27,26,12,2,39,7,14,17,11,42,37,40,43,28,38,41,4,1,33,8,10,5,18,6,30,20,31,9,13,19,21,22,24,15,35,34,29,36,25,23,3,32,16],"text":["Peso: 0.171<br />reorder(Metabolito, Peso): aspartic acid","Peso: 0.168<br />reorder(Metabolito, Peso): asparagine","Peso: 0.109<br />reorder(Metabolito, Peso): serine","Peso: 0.007<br />reorder(Metabolito, Peso): glycine","Peso: 0.202<br />reorder(Metabolito, Peso): alanine","Peso: 0.065<br />reorder(Metabolito, Peso): glutamic acid","Peso: 0.114<br />reorder(Metabolito, Peso): glutamine","Peso: 0.134<br />reorder(Metabolito, Peso): threonine","Peso: 0.107<br />reorder(Metabolito, Peso): proline","Peso: 0.222<br />reorder(Metabolito, Peso): valine","Peso: 0.195<br />reorder(Metabolito, Peso): tryptophan","Peso: 0.212<br />reorder(Metabolito, Peso): isoleucine","Peso: 0.225<br />reorder(Metabolito, Peso): leucine","Peso: 0.172<br />reorder(Metabolito, Peso): phenylalanine","Peso: 0.199<br />reorder(Metabolito, Peso): pyruvate","Peso: 0.216<br />reorder(Metabolito, Peso): lactate","Peso: 0.032<br />reorder(Metabolito, Peso): phosphorate","Peso: 0.003<br />reorder(Metabolito, Peso): n-butylamine","Peso: 0.187<br />reorder(Metabolito, Peso): ethanolamine","Peso: 0.068<br />reorder(Metabolito, Peso): glycerol","Peso: 0.093<br />reorder(Metabolito, Peso): succinate","Peso: 0.044<br />reorder(Metabolito, Peso): glycerate","Peso: 0.145<br />reorder(Metabolito, Peso): fumarate","Peso: 0.050<br />reorder(Metabolito, Peso): cadaverine","Peso: 0.177<br />reorder(Metabolito, Peso): malate","Peso: 0.154<br />reorder(Metabolito, Peso): 4-aminobutyrate","Peso: 0.185<br />reorder(Metabolito, Peso): cysteine","Peso: 0.090<br />reorder(Metabolito, Peso): a-ketoglutarate","Peso: 0.113<br />reorder(Metabolito, Peso): aconitate","Peso: 0.151<br />reorder(Metabolito, Peso): putrescine","Peso: 0.156<br />reorder(Metabolito, Peso): ribonate","Peso: 0.161<br />reorder(Metabolito, Peso): shikimate","Peso: 0.166<br />reorder(Metabolito, Peso): citrate","Peso: 0.122<br />reorder(Metabolito, Peso): D-fructose","Peso: 0.189<br />reorder(Metabolito, Peso): glucose","Peso: 0.188<br />reorder(Metabolito, Peso): lysine","Peso: 0.175<br />reorder(Metabolito, Peso): tyrosine","Peso: 0.194<br />reorder(Metabolito, Peso): gluconate","Peso: 0.167<br />reorder(Metabolito, Peso): galactonate","Peso: 0.164<br />reorder(Metabolito, Peso): inositol","Peso: 0.018<br />reorder(Metabolito, Peso): uric acid","Peso: 0.185<br />reorder(Metabolito, Peso): sucrose","Peso: 0.123<br />reorder(Metabolito, Peso): trehalose"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(238,59,59,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":43.7625570776256,"r":7.30593607305936,"b":40.1826484018265,"l":113.24200913242},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"title":{"text":"Pesos o loadigns en PC1","font":{"color":"rgba(0,0,0,1)","family":"","size":17.5342465753425},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.01125,0.23625],"tickmode":"array","ticktext":["0.00","0.05","0.10","0.15","0.20"],"tickvals":[0,0.05,0.1,0.15,0.2],"categoryorder":"array","categoryarray":["0.00","0.05","0.10","0.15","0.20"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"y","title":{"text":"Peso","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.4,43.6],"tickmode":"array","ticktext":["n-butylamine","glycine","uric acid","phosphorate","glycerate","cadaverine","glutamic acid","glycerol","a-ketoglutarate","succinate","proline","serine","aconitate","glutamine","D-fructose","trehalose","threonine","fumarate","putrescine","4-aminobutyrate","ribonate","shikimate","inositol","citrate","galactonate","asparagine","aspartic acid","phenylalanine","tyrosine","malate","cysteine","sucrose","ethanolamine","lysine","glucose","gluconate","tryptophan","pyruvate","alanine","isoleucine","lactate","valine","leucine"],"tickvals":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43],"categoryorder":"array","categoryarray":["n-butylamine","glycine","uric acid","phosphorate","glycerate","cadaverine","glutamic acid","glycerol","a-ketoglutarate","succinate","proline","serine","aconitate","glutamine","D-fructose","trehalose","threonine","fumarate","putrescine","4-aminobutyrate","ribonate","shikimate","inositol","citrate","galactonate","asparagine","aspartic acid","phenylalanine","tyrosine","malate","cysteine","sucrose","ethanolamine","lysine","glucose","gluconate","tryptophan","pyruvate","alanine","isoleucine","lactate","valine","leucine"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":{"text":"Metabolito","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"1ec692245ed":{"x":{},"y":{},"xend":{},"yend":{},"type":"scatter"},"1ec3c9f13e6":{"x":{},"y":{}}},"cur_data":"1ec692245ed","visdat":{"1ec692245ed":["function (y) ","x"],"1ec3c9f13e6":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
```

Para los pesos del segundo componente principal seguimos el mismo procedimiento.  


```r
# Obtener los pesos correspondientes de PC1
pesos_pc2 <- met_pca$rotation %>% 
  as.data.frame() %>% 
  select(PC2) %>% 
  mutate(Metabolito = row.names(met_pca$rotation)) %>% 
  mutate(PC2 = round(abs(PC2), 3)) %>% 
  rename(Peso = PC2)

# Gráfica de paleta con pesos de mayor a menor
lolch_ppc2 <- pesos_pc2 %>% 
  ggplot(aes(x = Peso, y = reorder(Metabolito, Peso))) + 
  geom_segment(aes(x = 0, xend = Peso, yend = Metabolito), color = "black") +
  geom_point(col = "black", pch = 21, bg = "#EE3B3B") +
  xlab("Peso") +
  ylab("Metabolito") +
  ggtitle("Pesos o loadigns en PC2") +
  theme_classic()

# Aspecto interactivo con ggplotly()
ggplotly(lolch_ppc2)
```

```{=html}
<div id="htmlwidget-efdd169d1a98a2425a07" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-efdd169d1a98a2425a07">{"x":{"data":[{"x":[0,0.018,null,0,0.03,null,0,0.039,null,0,0.128,null,0,0.001,null,0,0.095,null,0,0.19,null,0,0.187,null,0,0.176,null,0,0.006,null,0,0.121,null,0,0.054,null,0,0.03,null,0,0.179,null,0,0.09,null,0,0.095,null,0,0.288,null,0,0.043,null,0,0.072,null,0,0.238,null,0,0.268,null,0,0.256,null,0,0.232,null,0,0.119,null,0,0.095,null,0,0.169,null,0,0.087,null,0,0.121,null,0,0.052,null,0,0.06,null,0,0.105,null,0,0.211,null,0,0.176,null,0,0.223,null,0,0.164,null,0,0.11,null,0,0.138,null,0,0.149,null,0,0.153,null,0,0.166,null,0,0.203,null,0,0.178,null,0,0.211],"y":[3,3,null,4,4,null,6,6,null,22,22,null,1,1,null,14,14,null,34,34,null,33,33,null,30,30,null,2,2,null,21,21,null,9,9,null,5,5,null,32,32,null,13,13,null,15,15,null,43,43,null,7,7,null,11,11,null,40,40,null,42,42,null,41,41,null,39,39,null,19,19,null,16,16,null,28,28,null,12,12,null,20,20,null,8,8,null,10,10,null,17,17,null,36,36,null,29,29,null,38,38,null,26,26,null,18,18,null,23,23,null,24,24,null,25,25,null,27,27,null,35,35,null,31,31,null,37,37],"text":["x: 0<br />reorder(Metabolito, Peso): aspartic acid<br />Peso: 0.018<br />Metabolito:  3","x: 0<br />reorder(Metabolito, Peso): aspartic acid<br />Peso: 0.018<br />Metabolito:  3",null,"x: 0<br />reorder(Metabolito, Peso): asparagine<br />Peso: 0.030<br />Metabolito:  4","x: 0<br />reorder(Metabolito, Peso): asparagine<br />Peso: 0.030<br />Metabolito:  4",null,"x: 0<br />reorder(Metabolito, Peso): serine<br />Peso: 0.039<br />Metabolito:  6","x: 0<br />reorder(Metabolito, Peso): serine<br />Peso: 0.039<br />Metabolito:  6",null,"x: 0<br />reorder(Metabolito, Peso): glycine<br />Peso: 0.128<br />Metabolito: 22","x: 0<br />reorder(Metabolito, Peso): glycine<br />Peso: 0.128<br />Metabolito: 22",null,"x: 0<br />reorder(Metabolito, Peso): alanine<br />Peso: 0.001<br />Metabolito:  1","x: 0<br />reorder(Metabolito, Peso): alanine<br />Peso: 0.001<br />Metabolito:  1",null,"x: 0<br />reorder(Metabolito, Peso): glutamic acid<br />Peso: 0.095<br />Metabolito: 14","x: 0<br />reorder(Metabolito, Peso): glutamic acid<br />Peso: 0.095<br />Metabolito: 14",null,"x: 0<br />reorder(Metabolito, Peso): glutamine<br />Peso: 0.190<br />Metabolito: 34","x: 0<br />reorder(Metabolito, Peso): glutamine<br />Peso: 0.190<br />Metabolito: 34",null,"x: 0<br />reorder(Metabolito, Peso): threonine<br />Peso: 0.187<br />Metabolito: 33","x: 0<br />reorder(Metabolito, Peso): threonine<br />Peso: 0.187<br />Metabolito: 33",null,"x: 0<br />reorder(Metabolito, Peso): proline<br />Peso: 0.176<br />Metabolito: 30","x: 0<br />reorder(Metabolito, Peso): proline<br />Peso: 0.176<br />Metabolito: 30",null,"x: 0<br />reorder(Metabolito, Peso): valine<br />Peso: 0.006<br />Metabolito:  2","x: 0<br />reorder(Metabolito, Peso): valine<br />Peso: 0.006<br />Metabolito:  2",null,"x: 0<br />reorder(Metabolito, Peso): tryptophan<br />Peso: 0.121<br />Metabolito: 21","x: 0<br />reorder(Metabolito, Peso): tryptophan<br />Peso: 0.121<br />Metabolito: 21",null,"x: 0<br />reorder(Metabolito, Peso): isoleucine<br />Peso: 0.054<br />Metabolito:  9","x: 0<br />reorder(Metabolito, Peso): isoleucine<br />Peso: 0.054<br />Metabolito:  9",null,"x: 0<br />reorder(Metabolito, Peso): leucine<br />Peso: 0.030<br />Metabolito:  5","x: 0<br />reorder(Metabolito, Peso): leucine<br />Peso: 0.030<br />Metabolito:  5",null,"x: 0<br />reorder(Metabolito, Peso): phenylalanine<br />Peso: 0.179<br />Metabolito: 32","x: 0<br />reorder(Metabolito, Peso): phenylalanine<br />Peso: 0.179<br />Metabolito: 32",null,"x: 0<br />reorder(Metabolito, Peso): pyruvate<br />Peso: 0.090<br />Metabolito: 13","x: 0<br />reorder(Metabolito, Peso): pyruvate<br />Peso: 0.090<br />Metabolito: 13",null,"x: 0<br />reorder(Metabolito, Peso): lactate<br />Peso: 0.095<br />Metabolito: 15","x: 0<br />reorder(Metabolito, Peso): lactate<br />Peso: 0.095<br />Metabolito: 15",null,"x: 0<br />reorder(Metabolito, Peso): phosphorate<br />Peso: 0.288<br />Metabolito: 43","x: 0<br />reorder(Metabolito, Peso): phosphorate<br />Peso: 0.288<br />Metabolito: 43",null,"x: 0<br />reorder(Metabolito, Peso): n-butylamine<br />Peso: 0.043<br />Metabolito:  7","x: 0<br />reorder(Metabolito, Peso): n-butylamine<br />Peso: 0.043<br />Metabolito:  7",null,"x: 0<br />reorder(Metabolito, Peso): ethanolamine<br />Peso: 0.072<br />Metabolito: 11","x: 0<br />reorder(Metabolito, Peso): ethanolamine<br />Peso: 0.072<br />Metabolito: 11",null,"x: 0<br />reorder(Metabolito, Peso): glycerol<br />Peso: 0.238<br />Metabolito: 40","x: 0<br />reorder(Metabolito, Peso): glycerol<br />Peso: 0.238<br />Metabolito: 40",null,"x: 0<br />reorder(Metabolito, Peso): succinate<br />Peso: 0.268<br />Metabolito: 42","x: 0<br />reorder(Metabolito, Peso): succinate<br />Peso: 0.268<br />Metabolito: 42",null,"x: 0<br />reorder(Metabolito, Peso): glycerate<br />Peso: 0.256<br />Metabolito: 41","x: 0<br />reorder(Metabolito, Peso): glycerate<br />Peso: 0.256<br />Metabolito: 41",null,"x: 0<br />reorder(Metabolito, Peso): fumarate<br />Peso: 0.232<br />Metabolito: 39","x: 0<br />reorder(Metabolito, Peso): fumarate<br />Peso: 0.232<br />Metabolito: 39",null,"x: 0<br />reorder(Metabolito, Peso): cadaverine<br />Peso: 0.119<br />Metabolito: 19","x: 0<br />reorder(Metabolito, Peso): cadaverine<br />Peso: 0.119<br />Metabolito: 19",null,"x: 0<br />reorder(Metabolito, Peso): malate<br />Peso: 0.095<br />Metabolito: 16","x: 0<br />reorder(Metabolito, Peso): malate<br />Peso: 0.095<br />Metabolito: 16",null,"x: 0<br />reorder(Metabolito, Peso): 4-aminobutyrate<br />Peso: 0.169<br />Metabolito: 28","x: 0<br />reorder(Metabolito, Peso): 4-aminobutyrate<br />Peso: 0.169<br />Metabolito: 28",null,"x: 0<br />reorder(Metabolito, Peso): cysteine<br />Peso: 0.087<br />Metabolito: 12","x: 0<br />reorder(Metabolito, Peso): cysteine<br />Peso: 0.087<br />Metabolito: 12",null,"x: 0<br />reorder(Metabolito, Peso): a-ketoglutarate<br />Peso: 0.121<br />Metabolito: 20","x: 0<br />reorder(Metabolito, Peso): a-ketoglutarate<br />Peso: 0.121<br />Metabolito: 20",null,"x: 0<br />reorder(Metabolito, Peso): aconitate<br />Peso: 0.052<br />Metabolito:  8","x: 0<br />reorder(Metabolito, Peso): aconitate<br />Peso: 0.052<br />Metabolito:  8",null,"x: 0<br />reorder(Metabolito, Peso): putrescine<br />Peso: 0.060<br />Metabolito: 10","x: 0<br />reorder(Metabolito, Peso): putrescine<br />Peso: 0.060<br />Metabolito: 10",null,"x: 0<br />reorder(Metabolito, Peso): ribonate<br />Peso: 0.105<br />Metabolito: 17","x: 0<br />reorder(Metabolito, Peso): ribonate<br />Peso: 0.105<br />Metabolito: 17",null,"x: 0<br />reorder(Metabolito, Peso): shikimate<br />Peso: 0.211<br />Metabolito: 36","x: 0<br />reorder(Metabolito, Peso): shikimate<br />Peso: 0.211<br />Metabolito: 36",null,"x: 0<br />reorder(Metabolito, Peso): citrate<br />Peso: 0.176<br />Metabolito: 29","x: 0<br />reorder(Metabolito, Peso): citrate<br />Peso: 0.176<br />Metabolito: 29",null,"x: 0<br />reorder(Metabolito, Peso): D-fructose<br />Peso: 0.223<br />Metabolito: 38","x: 0<br />reorder(Metabolito, Peso): D-fructose<br />Peso: 0.223<br />Metabolito: 38",null,"x: 0<br />reorder(Metabolito, Peso): glucose<br />Peso: 0.164<br />Metabolito: 26","x: 0<br />reorder(Metabolito, Peso): glucose<br />Peso: 0.164<br />Metabolito: 26",null,"x: 0<br />reorder(Metabolito, Peso): lysine<br />Peso: 0.110<br />Metabolito: 18","x: 0<br />reorder(Metabolito, Peso): lysine<br />Peso: 0.110<br />Metabolito: 18",null,"x: 0<br />reorder(Metabolito, Peso): tyrosine<br />Peso: 0.138<br />Metabolito: 23","x: 0<br />reorder(Metabolito, Peso): tyrosine<br />Peso: 0.138<br />Metabolito: 23",null,"x: 0<br />reorder(Metabolito, Peso): gluconate<br />Peso: 0.149<br />Metabolito: 24","x: 0<br />reorder(Metabolito, Peso): gluconate<br />Peso: 0.149<br />Metabolito: 24",null,"x: 0<br />reorder(Metabolito, Peso): galactonate<br />Peso: 0.153<br />Metabolito: 25","x: 0<br />reorder(Metabolito, Peso): galactonate<br />Peso: 0.153<br />Metabolito: 25",null,"x: 0<br />reorder(Metabolito, Peso): inositol<br />Peso: 0.166<br />Metabolito: 27","x: 0<br />reorder(Metabolito, Peso): inositol<br />Peso: 0.166<br />Metabolito: 27",null,"x: 0<br />reorder(Metabolito, Peso): uric acid<br />Peso: 0.203<br />Metabolito: 35","x: 0<br />reorder(Metabolito, Peso): uric acid<br />Peso: 0.203<br />Metabolito: 35",null,"x: 0<br />reorder(Metabolito, Peso): sucrose<br />Peso: 0.178<br />Metabolito: 31","x: 0<br />reorder(Metabolito, Peso): sucrose<br />Peso: 0.178<br />Metabolito: 31",null,"x: 0<br />reorder(Metabolito, Peso): trehalose<br />Peso: 0.211<br />Metabolito: 37","x: 0<br />reorder(Metabolito, Peso): trehalose<br />Peso: 0.211<br />Metabolito: 37"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.018,0.03,0.039,0.128,0.001,0.095,0.19,0.187,0.176,0.006,0.121,0.054,0.03,0.179,0.09,0.095,0.288,0.043,0.072,0.238,0.268,0.256,0.232,0.119,0.095,0.169,0.087,0.121,0.052,0.06,0.105,0.211,0.176,0.223,0.164,0.11,0.138,0.149,0.153,0.166,0.203,0.178,0.211],"y":[3,4,6,22,1,14,34,33,30,2,21,9,5,32,13,15,43,7,11,40,42,41,39,19,16,28,12,20,8,10,17,36,29,38,26,18,23,24,25,27,35,31,37],"text":["Peso: 0.018<br />reorder(Metabolito, Peso): aspartic acid","Peso: 0.030<br />reorder(Metabolito, Peso): asparagine","Peso: 0.039<br />reorder(Metabolito, Peso): serine","Peso: 0.128<br />reorder(Metabolito, Peso): glycine","Peso: 0.001<br />reorder(Metabolito, Peso): alanine","Peso: 0.095<br />reorder(Metabolito, Peso): glutamic acid","Peso: 0.190<br />reorder(Metabolito, Peso): glutamine","Peso: 0.187<br />reorder(Metabolito, Peso): threonine","Peso: 0.176<br />reorder(Metabolito, Peso): proline","Peso: 0.006<br />reorder(Metabolito, Peso): valine","Peso: 0.121<br />reorder(Metabolito, Peso): tryptophan","Peso: 0.054<br />reorder(Metabolito, Peso): isoleucine","Peso: 0.030<br />reorder(Metabolito, Peso): leucine","Peso: 0.179<br />reorder(Metabolito, Peso): phenylalanine","Peso: 0.090<br />reorder(Metabolito, Peso): pyruvate","Peso: 0.095<br />reorder(Metabolito, Peso): lactate","Peso: 0.288<br />reorder(Metabolito, Peso): phosphorate","Peso: 0.043<br />reorder(Metabolito, Peso): n-butylamine","Peso: 0.072<br />reorder(Metabolito, Peso): ethanolamine","Peso: 0.238<br />reorder(Metabolito, Peso): glycerol","Peso: 0.268<br />reorder(Metabolito, Peso): succinate","Peso: 0.256<br />reorder(Metabolito, Peso): glycerate","Peso: 0.232<br />reorder(Metabolito, Peso): fumarate","Peso: 0.119<br />reorder(Metabolito, Peso): cadaverine","Peso: 0.095<br />reorder(Metabolito, Peso): malate","Peso: 0.169<br />reorder(Metabolito, Peso): 4-aminobutyrate","Peso: 0.087<br />reorder(Metabolito, Peso): cysteine","Peso: 0.121<br />reorder(Metabolito, Peso): a-ketoglutarate","Peso: 0.052<br />reorder(Metabolito, Peso): aconitate","Peso: 0.060<br />reorder(Metabolito, Peso): putrescine","Peso: 0.105<br />reorder(Metabolito, Peso): ribonate","Peso: 0.211<br />reorder(Metabolito, Peso): shikimate","Peso: 0.176<br />reorder(Metabolito, Peso): citrate","Peso: 0.223<br />reorder(Metabolito, Peso): D-fructose","Peso: 0.164<br />reorder(Metabolito, Peso): glucose","Peso: 0.110<br />reorder(Metabolito, Peso): lysine","Peso: 0.138<br />reorder(Metabolito, Peso): tyrosine","Peso: 0.149<br />reorder(Metabolito, Peso): gluconate","Peso: 0.153<br />reorder(Metabolito, Peso): galactonate","Peso: 0.166<br />reorder(Metabolito, Peso): inositol","Peso: 0.203<br />reorder(Metabolito, Peso): uric acid","Peso: 0.178<br />reorder(Metabolito, Peso): sucrose","Peso: 0.211<br />reorder(Metabolito, Peso): trehalose"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(238,59,59,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":43.7625570776256,"r":7.30593607305936,"b":40.1826484018265,"l":113.24200913242},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"title":{"text":"Pesos o loadigns en PC2","font":{"color":"rgba(0,0,0,1)","family":"","size":17.5342465753425},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.0144,0.3024],"tickmode":"array","ticktext":["0.0","0.1","0.2","0.3"],"tickvals":[0,0.1,0.2,0.3],"categoryorder":"array","categoryarray":["0.0","0.1","0.2","0.3"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"y","title":{"text":"Peso","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.4,43.6],"tickmode":"array","ticktext":["alanine","valine","aspartic acid","asparagine","leucine","serine","n-butylamine","aconitate","isoleucine","putrescine","ethanolamine","cysteine","pyruvate","glutamic acid","lactate","malate","ribonate","lysine","cadaverine","a-ketoglutarate","tryptophan","glycine","tyrosine","gluconate","galactonate","glucose","inositol","4-aminobutyrate","citrate","proline","sucrose","phenylalanine","threonine","glutamine","uric acid","shikimate","trehalose","D-fructose","fumarate","glycerol","glycerate","succinate","phosphorate"],"tickvals":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43],"categoryorder":"array","categoryarray":["alanine","valine","aspartic acid","asparagine","leucine","serine","n-butylamine","aconitate","isoleucine","putrescine","ethanolamine","cysteine","pyruvate","glutamic acid","lactate","malate","ribonate","lysine","cadaverine","a-ketoglutarate","tryptophan","glycine","tyrosine","gluconate","galactonate","glucose","inositol","4-aminobutyrate","citrate","proline","sucrose","phenylalanine","threonine","glutamine","uric acid","shikimate","trehalose","D-fructose","fumarate","glycerol","glycerate","succinate","phosphorate"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":{"text":"Metabolito","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"1ec165f284c":{"x":{},"y":{},"xend":{},"yend":{},"type":"scatter"},"1ec336b57de":{"x":{},"y":{}}},"cur_data":"1ec165f284c","visdat":{"1ec165f284c":["function (y) ","x"],"1ec336b57de":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
```

¿Cómo varían las cantidades de estos compuestos respecto al tiempo de estrés salino? Un primer paso podría ser realizar análisis de una sola variable en los metabolitos de mayor importancia (ANOVA y comparaciones múltiples).  

¿Qué significa que algún metabolito tenga una mayor importancia o relevancia? La respuesta a esta pregunta dependerá del marco teórico de la investigación, tal vez algunos de estos compuestos tengan un papel central en el control del metabolismo ante situaciones de estrés.  
